{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints related to quiz attempts in a FastAPI backend. It includes routes for starting an attempt, answering questions, submitting an attempt (calculating the score), and fetching attempt status. The file also manages database table creation and performs SQL queries related to attempts and answers.", "external_files": ["src.api.db"], "external_methods": ["get_connection"], "published": ["start_attempt", "answer_question", "submit_attempt", "get_attempt"], "classes": [{"name": "StartAttemptRequest", "description": "Pydantic model for starting an attempt, capturing user name and quiz ID."}, {"name": "StartAttemptResponse", "description": "Pydantic model for response after starting an attempt, returning attempt ID."}, {"name": "AnswerRequest", "description": "Pydantic model for recording an answer, including question ID and selected option."}, {"name": "AttemptStatusResponse", "description": "Pydantic model for retrieving attempt status and progress."}, {"name": "SubmitAttemptRequest", "description": "Pydantic model for submitting an attempt, includes optional time taken."}, {"name": "SubmitAttemptResponse", "description": "Pydantic model for response after submitting an attempt, including score and total questions."}], "methods": [{"name": "bool _table_exists(cur, table_name: str)", "description": "Checks if a specified table exists in the database.", "scope": "", "scopeKind": ""}, {"name": "_ensure_attempt_tables(cur)", "description": "Creates the attempts and attempt_answers tables if they do not exist.", "scope": "", "scopeKind": ""}, {"name": "StartAttemptResponse start_attempt(payload: StartAttemptRequest)", "description": "Starts a new quiz attempt and returns the attempt ID.", "scope": "", "scopeKind": ""}, {"name": "answer_question( attempt_id: int = Path(..., description=\"Attempt identifier\"), payload: AnswerRequest = None, )", "description": "Records or updates an answer for a specific attempt and question.", "scope": "", "scopeKind": ""}, {"name": "SubmitAttemptResponse submit_attempt( attempt_id: int = Path(..., description=\"Attempt identifier\"), payload: SubmitAttemptRequest = None, )", "description": "Calculates and records the score for an attempt, marking it as submitted.", "scope": "", "scopeKind": ""}, {"name": "AttemptStatusResponse get_attempt(attempt_id: int = Path(..., description=\"Attempt identifier\"))", "description": "Fetches the current status and details of a specific attempt.", "scope": "", "scopeKind": ""}], "calls": ["get_connection()", "cur.execute(...)", "cur.fetchone()", "cur.fetchall()"], "search-terms": ["attempts", "quiz_attempt", "answer_recording", "score_calculation", "attempt_tracking", "submissions"], "state": 2, "file_id": 10, "knowledge_revision": 28, "git_revision": "", "revision_history": [{"23": ""}, {"28": ""}], "ctags": [{"_type": "tag", "name": "AnswerRequest", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^class AnswerRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AttemptStatusResponse", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^class AttemptStatusResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StartAttemptRequest", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^class StartAttemptRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StartAttemptResponse", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^class StartAttemptResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SubmitAttemptRequest", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^class SubmitAttemptRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SubmitAttemptResponse", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^class SubmitAttemptResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_ensure_attempt_tables", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^def _ensure_attempt_tables(cur):$/", "language": "Python", "kind": "function", "signature": "(cur)"}, {"_type": "tag", "name": "_table_exists", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^def _table_exists(cur, table_name: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(cur, table_name: str)"}, {"_type": "tag", "name": "answer_question", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^def answer_question($/", "language": "Python", "kind": "function", "signature": "( attempt_id: int = Path(..., description=\"Attempt identifier\"), payload: AnswerRequest = None, )"}, {"_type": "tag", "name": "answers_count", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    answers_count: int = Field(..., description=\"How many answers recorded so far\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "attempt_id", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    attempt_id: int = Field(..., description=\"Attempt identifier\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "attempt_id", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    attempt_id: int = Field(..., description=\"Attempt identifier\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "SubmitAttemptResponse", "scopeKind": "class"}, {"_type": "tag", "name": "attempt_id", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    attempt_id: int = Field(..., description=\"New attempt identifier\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "StartAttemptResponse", "scopeKind": "class"}, {"_type": "tag", "name": "get_attempt", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^def get_attempt(attempt_id: int = Path(..., description=\"Attempt identifier\")) -> AttemptStatusR/", "language": "Python", "typeref": "typename:AttemptStatusResponse", "kind": "function", "signature": "(attempt_id: int = Path(..., description=\"Attempt identifier\"))"}, {"_type": "tag", "name": "is_submitted", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    is_submitted: bool = Field(..., description=\"Whether the attempt is submitted\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "question_id", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    question_id: int = Field(..., description=\"Question identifier\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "AnswerRequest", "scopeKind": "class"}, {"_type": "tag", "name": "quiz_id", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    quiz_id: int = Field(..., description=\"Quiz identifier\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "quiz_id", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    quiz_id: int = Field(..., description=\"Quiz identifier\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "StartAttemptRequest", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^router = APIRouter(prefix=\"\\/attempts\", tags=[\"Attempts\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "score", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    score: Optional[int] = Field(None, description=\"Score if submitted\")$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "score", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    score: int = Field(..., description=\"Computed score\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "SubmitAttemptResponse", "scopeKind": "class"}, {"_type": "tag", "name": "selected_option", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    selected_option: str = Field(..., description=\"Selected option letter A\\/B\\/C\\/D\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "AnswerRequest", "scopeKind": "class"}, {"_type": "tag", "name": "start_attempt", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^def start_attempt(payload: StartAttemptRequest) -> StartAttemptResponse:$/", "language": "Python", "typeref": "typename:StartAttemptResponse", "kind": "function", "signature": "(payload: StartAttemptRequest)"}, {"_type": "tag", "name": "submit_attempt", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^def submit_attempt($/", "language": "Python", "typeref": "typename:SubmitAttemptResponse", "kind": "function", "signature": "( attempt_id: int = Path(..., description=\"Attempt identifier\"), payload: SubmitAttemptRequest = None, )"}, {"_type": "tag", "name": "time_taken_seconds", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    time_taken_seconds: Optional[int] = Field(None, description=\"Time if submitted\")$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "time_taken_seconds", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    time_taken_seconds: Optional[int] = Field(None, description=\"Time taken in seconds\")$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "SubmitAttemptRequest", "scopeKind": "class"}, {"_type": "tag", "name": "total_questions", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    total_questions: Optional[int] = Field(None, description=\"Total questions if submitted\")$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "total_questions", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    total_questions: int = Field(..., description=\"Total answered questions\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "SubmitAttemptResponse", "scopeKind": "class"}, {"_type": "tag", "name": "user_name", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    user_name: str = Field(..., description=\"User name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "AttemptStatusResponse", "scopeKind": "class"}, {"_type": "tag", "name": "user_name", "path": "/home/kavia/workspace/code-generation/quiz-master-4204-4420/quiz_backend/src/api/routers/attempts.py", "pattern": "/^    user_name: str = Field(..., description=\"User's display name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "StartAttemptRequest", "scopeKind": "class"}], "hash": "923388e627c40b055ce1237594779553", "format-version": 4, "code-base-name": "quiz_backend", "filename": "quiz_backend/src/api/routers/attempts.py", "fields": [{"name": "int answers_count", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int attempt_id", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_submitted", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int question_id", "scope": "AnswerRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "int quiz_id", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/attempts\", tags=[\"Attempts\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[int] score", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int score", "scope": "SubmitAttemptResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str selected_option", "scope": "AnswerRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[int] time_taken_seconds", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[int] total_questions", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int total_questions", "scope": "SubmitAttemptResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str user_name", "scope": "AttemptStatusResponse", "scopeKind": "class", "description": "unavailable"}]}